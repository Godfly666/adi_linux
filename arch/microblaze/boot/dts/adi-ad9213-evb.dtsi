// SPDX-License-Identifier: GPL-2.0iio
#include <dt-bindings/iio/frequency/hmc7044.h>

&fmc_spi {
	status = "okay";

	hmc7044: hmc7044@1 {
		reg = <1>;
		#address-cells = <1>;
		#size-cells = <0>;
		#clock-cells = <1>;
		compatible = "adi,hmc7044";
		spi-max-frequency = <10000000>;

		jesd204-device;
		#jesd204-cells = <2>;
		jesd204-sysref-provider;
		adi,jesd204-max-sysref-frequency-hz = <20000000>;

		adi,pll1-clkin-frequencies = <0 0 0 100000000>;
		adi,vcxo-frequency = <125000000>;

		adi,pll1-loop-bandwidth-hz = <200>;

		adi,pll2-output-frequency = <2500000000>;

		adi,sysref-timer-divider = <1024>;
		adi,pulse-generator-mode = <0>;
		
		adi,clkin3-buffer-mode  = <0x15>;
		adi,oscin-buffer-mode = <0x15>;

		adi,gpi-controls = <0x00 0x00 0x00 0x00>;
		adi,gpo-controls = <0x1f 0x2b 0x00 0x00>;

		clock-output-names =
			"hmc7044_out0", "hmc7044_out1", "hmc7044_out2",
			"hmc7044_out3", "hmc7044_out4", "hmc7044_out5",
			"hmc7044_out6", "hmc7044_out7", "hmc7044_out8",
			"hmc7044_out9", "hmc7044_out10", "hmc7044_out11",
			"hmc7044_out12", "hmc7044_out13";

		hmc7044_c1: channel@1 {
			reg = <1>;
			adi,extended-name = "FMC_SYSREF";
			adi,divider = <128>;
			adi,driver-mode = <1>;	// LVPECL
			adi,jesd204-sysref-chan;
		};
		hmc7044_c4: channel@4 {
			reg = <4>;
			adi,extended-name = "CLKOUT_MMCX";
			adi,divider = <8>;	
			adi,driver-mode = <1>;	// LVPECL
		};
		hmc7044_c5: channel@5 {
			reg = <5>;
			adi,extended-name = "CLK_COPY";
			adi,divider = <4>;	
			adi,driver-mode = <1>;	// LVPECL
		};
		hmc7044_c7: channel@7 {
			reg = <7>;
			adi,extended-name = "FMC_REFCLK1";
			adi,divider = <4>;	
			adi,driver-mode = <1>;	// LVPECL
		};
		hmc7044_c9: channel@9 {
			reg = <9>;
			adi,extended-name = "CORE_CLK";
			adi,divider = <8>;	
			adi,driver-mode = <1>;	// LVPECL
		};
		hmc7044_c11: channel@11 {
			reg = <11>;
			adi,extended-name = "FMC_REFCLK";
			adi,divider = <8>;	
			adi,driver-mode = <1>;	// LVPECL
		};
	};
	
	adf4371: adf4371@2 {
		compatible = "adi,adf4371";
		reg = <2>;

		#address-cells = <1>;
		#clock-cells = <1>;
		#size-cells = <0>;

		spi-max-frequency = <10000000>;
		adi,spi-3wire-enable;
		adi,muxout-select = <1>;
		clocks = <&hmc7044 5>;
		clock-names = "clkin";
		clock-output-names = "pll0-clk-rf8", "pll0-clk-rfaux8",
			"pll0-clk-rf16", "pll0-clk-rf32";

		channel@2 {
			reg = <2>;
			adi,output-enable;
			adi,power-up-frequency = /bits/ 64 <10000000000>;
		};
	};

	adc_ad9213: ad9213@0 {
		compatible = "adi,ad9213";
		reg = <0>;
		#address-cells = <1>;
		#size-cells = <0>;
		spi-max-frequency = <10000000>;

		clocks =  <&adf4371 2>, <&axi_ad9213_jesd_rx>, <&hmc7044 9>;
		clock-names = "sample_clk", "jesd_clk", "core_clk";

		clock-output-names = "sampl_clk";
		#clock-cells = <1>;

		jesd204-device;
		#jesd204-cells = <2>;
		jesd204-top-device = <0>; /* This is the TOP device */
		jesd204-link-ids = <0>;
		jesd204-inputs = <&rx_ad9213_tpl_core_tpl 0 0>;

		//adi,syncinb-c0mos-enable;
		adi,version = <1>;

		adi,octets-per-frame = <2>;
		adi,frames-per-multiframe = <32>;
		adi,converter-resolution = <16>;
		adi,bits-per-sample = <16>;
		adi,converters-per-device = <1>;
		adi,control-bits-per-sample = <0>;
		adi,lanes-per-device = <16>;
		adi,subclass = <1>;
		adi,high-density = <0>;
		adi,samples-per-converter-per-frame = <16>;
	};
};
